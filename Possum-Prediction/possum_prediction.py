# -*- coding: utf-8 -*-
"""Possum_Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1SFdZnx_Bq6YtBpC5D1P_NIRC3CBStQmi

# Possum Prediction

## Importing the libraries
"""

import numpy as np
import  pandas as pd
import matplotlib.pyplot as plt

"""## Importing the dataset"""

dataset = pd.read_csv('possum.csv')
X = dataset.drop(['totlngth'], axis=1)
y =  dataset['totlngth']

dataset.head()

X.shape

y.shape

"""## Preprocessing"""

X.isna().sum()

from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
X['Pop'] = le.fit_transform(X['Pop'])
X['sex'] = le.fit_transform(X['sex'])
X = X.drop(['case'], axis=1)

from sklearn.impute import SimpleImputer
imputer = SimpleImputer(strategy='mean')
X['age'] = imputer.fit_transform(X['age'].values.reshape(-1, 1))
X['footlgth'] = imputer.fit_transform(X['footlgth'].values.reshape(-1, 1))

X.head()

"""## Sspliting the dataset into trainig and test set"""

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

"""## Training the model"""

from sklearn.ensemble import RandomForestRegressor 
model = RandomForestRegressor()
model.fit(X_train, y_train)

"""## Predicting the model"""

y_pred = model.predict(X_test)

"""## Evaluating the model"""

from sklearn.metrics import r2_score
rSquared = r2_score(y_test, y_pred)
print(rSquared*100)